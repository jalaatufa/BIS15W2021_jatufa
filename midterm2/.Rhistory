change_pop = (max_pop-min_pop)) %>%
top_n(5, change_pop)
population_year %>%
filter(year == 1920 |year == 2020) %>%
group_by(country) %>%
summarise(1920_pop = min(population, na.rm=T),
population_year %>%
filter(year == 1920 |year == 2020) %>%
group_by(country) %>%
summarise(min_pop = min(population, na.rm=T),
max_pop = max(population, na.rm=T),
change_pop = (max_pop-min_pop)) %>%
top_n(5, change_pop)
life_expectancy_year %>%
filter(country == "Kuwait", between(year, 1920, 2020)) %>%
ggplot(aes(x= year, y= life_expectancy, color = country))+
geom_point(na.rm=T)+
labs(title = "Kuwait Life Expectancy from 1920 to 2020",
x = "Year",
y = "Life Expectancy")+
theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
axis.text.x = element_text(angle = 70, hjust = 1))+
theme_linedraw()+
scale_x_discrete(breaks=c("1920", "1925", "1930", "1935", "1940", "1945", "1950", "1955", "1960", "1965", "1970", "1975", "1980", "1985", "1990", "1995", "2000", "2005", "2010", "2015", "2020"))
life_expectancy_year %>%
filter(country == "Kuwait", between(year, 1920, 2020)) %>%
ggplot(aes(x= year, y= life_expectancy, color = country))+
geom_point(na.rm=T)+
labs(title = "Kuwait Life Expectancy from 1920 to 2020",
x = "Year",
y = "Life Expectancy")+
theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
axis.text.x = element_text(angle = 70, hjust = 1))+
theme_linedraw()+
scale_x_discrete(breaks=c("1920", "1925", "1930", "1935", "1940", "1945", "1950", "1955", "1960", "1965", "1970", "1975", "1980", "1985", "1990", "1995", "2000", "2005", "2010", "2015", "2020"))
life_expectancy_year %>%
filter(country == "Kuwait", between(year, 1920, 2020)) %>%
ggplot(aes(x= year, y= life_expectancy, color = country))+
geom_point(na.rm=T)+
labs(title = "Kuwait Life Expectancy from 1920 to 2020",
x = "Year",
y = "Life Expectancy")+
theme_linedraw()+
theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
axis.text.x = element_text(angle = 70, hjust = 1))+
scale_x_discrete(breaks=c("1920", "1925", "1930", "1935", "1940", "1945", "1950", "1955", "1960", "1965", "1970", "1975", "1980", "1985", "1990", "1995", "2000", "2005", "2010", "2015", "2020"))
population_year %>%
filter(country == "China", country == "India", country == "Indonesia", country == "Pakistan", country == "United States", between(year, 1920, 2020)) %>%
ggplot(aes(x= year, y= life_expectancy, color = country))+
geom_point(na.rm=T)+
labs(title = "Greatest Population Growth from 1920 to 2020",
x = "Year",
y = "Life Expectancy")+
theme_linedraw()+
theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
axis.text.x = element_text(angle = 70, hjust = 1))+
scale_x_discrete(breaks=c("1920", "1925", "1930", "1935", "1940", "1945", "1950", "1955", "1960", "1965", "1970", "1975", "1980", "1985", "1990", "1995", "2000", "2005", "2010", "2015", "2020"))
population_year %>%
filter(country == "China", country == "India", country == "Indonesia", country == "Pakistan", country == "United States", between(year, 1920, 2020)) %>%
ggplot(aes(x= year, y= population, color = country))+
geom_point(na.rm=T)+
labs(title = "Greatest Population Growth from 1920 to 2020",
x = "Year",
y = "Life Expectancy")+
theme_linedraw()+
theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
axis.text.x = element_text(angle = 70, hjust = 1))+
scale_x_discrete(breaks=c("1920", "1925", "1930", "1935", "1940", "1945", "1950", "1955", "1960", "1965", "1970", "1975", "1980", "1985", "1990", "1995", "2000", "2005", "2010", "2015", "2020"))
population_year %>%
filter(country == "China", country == "India", country == "Indonesia", country == "Pakistan", country == "United States", between(year, 1920, 2020)) %>%
ggplot(aes(x= year, y= population, color = country))+
geom_point(na.rm=T)
population_year %>%
filter(country == "China", country == "India", country == "Indonesia", country == "Pakistan", country == "United States", between(year, 1920, 2020))
population_year %>%
filter(country == "China", country == "India", country == "Indonesia", country == "Pakistan", country == "United States", between(year, 1920, 2020))
population_year %>%
filter(country == "China", country == "India", country == "Indonesia", country == "Pakistan", country == "United States", between(year, 1920, 2020))
population_year %>%
filter(country == "China", country == "India", country == "Indonesia", country == "Pakistan", country == "United States", between(year, 1920, 2020))
population_year %>%
filter(country == "China", between(year, 1920, 2020))
population_year %>%
filter(country == "China"| country == "India", between(year, 1920, 2020))
population_year %>%
filter(country == "China" |country == "India" | country == "Indonesia" | country == "Pakistan" | country == "United States", between(year, 1920, 2020))
population_year %>%
filter(country == "China" |country == "India" | country == "Indonesia" | country == "Pakistan" | country == "United States", between(year, 1920, 2020)) %>%
ggplot(aes(x= year, y= population, color = country))+
geom_point(na.rm=T)labs(title = "Greatest Population Growth from 1920 to 2020",
population_year %>%
filter(country == "China" |country == "India" | country == "Indonesia" | country == "Pakistan" | country == "United States", between(year, 1920, 2020)) %>%
ggplot(aes(x= year, y= population, color= country))+
geom_point(na.rm=T)labs(title = "Greatest Population Growth from 1920 to 2020",
population_year %>%
filter(country == "China" |country == "India" | country == "Indonesia" | country == "Pakistan" | country == "United States", between(year, 1920, 2020)) %>%
ggplot(aes(x= year, y= population, color= country))+
geom_point(na.rm=T)+
labs(title = "Greatest Population Growth from 1920 to 2020",
x = "Year",
y = "Life Expectancy")+
theme_linedraw()+
theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
axis.text.x = element_text(angle = 70, hjust = 1))+
scale_x_discrete(breaks=c("1920", "1925", "1930", "1935", "1940", "1945", "1950", "1955", "1960", "1965", "1970", "1975", "1980", "1985", "1990", "1995", "2000", "2005", "2010", "2015", "2020"))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(here)
library(naniar)
#install.packages("gapminder")
library("gapminder")
view(gapminder)
gapminder<-clean_names(gapminder)
glimpse(gapminder)
names(gapminder)
dim(gapminder)
any_na(gapminder)
gapminder$year <- as.factor(gapminder$year)
life_expectancy <- gapminder %>%
group_by(year) %>%
summarize(mean_life_expectancy = mean(life_exp))
life_expectancy
life_expectancy %>%
ggplot(aes(x=year, y= mean_life_expectancy))+
geom_point()+theme_linedraw()+
theme(axis.text.x = element_text(angle = 15, hjust = 1), plot.title = element_text(hjust = 0)) +
labs(title = "Global Life Expectancy Through Time",
x = "Year",
y= "Age")
gapminder %>%
filter (year == 1952 | year == 2007) %>%
ggplot(aes(x= year, y= life_exp)) +
geom_boxplot(fill="pink")+
theme_linedraw()+
theme(axis.text.x = element_text(hjust = 1), plot.title = element_text(hjust = 0)) +
labs(title = "Distribution of Life Expectancy",
x = "Year",
y= "Age")
gapminder %>%
group_by(year, continent) %>%
summarise(mean_life_exp=mean(life_exp),
max_life_exp=max(life_exp),
min_life_exp=min(life_exp))
gapminder %>%
group_by(continent) %>%
ggplot(aes(x=continent,y=life_exp,fill = continent))+
geom_boxplot()+
theme_linedraw()+
theme(axis.text.x = element_text(hjust = 1), plot.title = element_text(hjust = 0))+
labs(title = "Life Expectancy by Continent",
x = "Year",
y= "Life Expectancy")
gapminder %>%
group_by(year, continent) %>%
summarize(life_exp = mean(life_exp)) %>%
ggplot(aes(x= continent, y= life_exp))+
geom_boxplot(fill="cyan")+
theme(axis.text.x = element_text(hjust = 0), plot.title = element_text(size = rel(1), hjust = .5)) +
labs(title = "Life Expectancy over the Years per Continent",
x = "Continent",
y= "Life Expectancy Average ")
gapminder %>%
group_by(gdp_percap, life_exp) %>%
ggplot(aes(x= log10(gdp_percap), y= life_exp, color = continent)) +
geom_point()+
theme(axis.text.x = element_text(hjust = 1), plot.title = element_text(size = rel(2), hjust = .5)) +
labs(title = "GDP vs Life Expectancy",
x = "Log 10 of per Capita GPP",
y= "Life Expectancy Average")
pop_growth<-gapminder %>%
group_by(country) %>%
filter(year=="1952"|year=="2007") %>%
mutate(pop_growth= pop-lag(pop, default=first(pop))) %>%
arrange(desc(pop_growth))
pop_growth
pop_growth %>%
filter(pop_growth>=133408087) %>%
ggplot(aes(x=country, y= log10(pop_growth), fill = country))+
geom_col()+
theme(axis.text.x = element_text(hjust = 1), plot.title = element_text(size = rel(1), hjust = .5)) +
labs(title = "Top 5 Fast Growing Countries",
x = "Country",
y= "Population Growth (Log 10)")
pop_growth %>%
filter(pop_growth>=133408087) %>%
ggplot(aes(x=country, y= log10(gdp_percap), fill= country))+
geom_col()+
theme(axis.text.x = element_text(hjust = 1), plot.title = element_text(size = rel(1), hjust = .5)) +
labs(title = "Top 5 Growing Countries Capita Growth",
x = "Country",
y= "Per Capita Growth (Log 10)")
gapminder %>%
group_by(pop, country) %>%
filter(year == "2007" & continent == "Asia") %>%
ggplot(aes(x=country, y=log10(pop), color=country))+
geom_point()+
theme(axis.text.x = element_text(angle = 90, hjust = 1), plot.title = element_text(hjust = 0)) +
labs(title = "Population in Asia in 2007",
x = "Country",
y= "Log Population")
income_gdp <- income_year %>%
filter(year == "1920" | year == "2020") %>%
group_by(country) %>%
summarise(min_inc = min(income, na.rm=T),
max_inc = max(income, na.rm=T),
change_inc = max_inc-min_inc) %>%
income_gdp <- income_year %>%
filter(year == "1920" | year == "2020") %>%
group_by(country) %>%
summarise(min_inc = min(income, na.rm=T),
max_inc = max(income, na.rm=T),
change_inc = max_inc-min_inc) %>%
View(income)
View(income_year)
income_gdp <- income_year %>%
filter(year == "1920" | year == "2020") %>%
group_by(country) %>%
summarise(min_inc = min(income, na.rm=T),
max_inc = max(income, na.rm=T),
change_inc = (max_inc-min_inc)) %>%
income_gdp <- income_year %>%
filter(year == "1920" | year == "2020") %>%
group_by(country) %>%
summarise(min_inc = min(income, na.rm=T),
max_inc = max(income, na.rm=T),
change_inc = (max_inc-min_inc)) %>%
income_gdp <-income_year %>%
filter(year == "1920" | year == "2020")%>%
group_by(country)%>%
summarise(min_inc = min(income, na.rm=T),
max_inc = max(income, na.rm=T),
change_inc = (max_inc-min_inc))
income_gdp <-income_year %>%
filter(year == "1920" | year == "2020")%>%
group_by(country)%>%
summarise(min_inc = min(income, na.rm=T),
max_inc = max(income, na.rm=T),
change_inc = (max_inc-min_inc))
income_gdp <-income_year %>%
filter(year == "1920" | year == "2020")%>%
summarise(min_inc = min(income, na.rm=T),
max_inc = max(income, na.rm=T),
change_inc = (max_inc-min_inc))
income_gdp <-income_year %>%
filter(year == "1920" | year == "2020")%>%
summarise(min_inc = min(income, na.rm=T),
max_inc = max(income, na.rm=T),
change_inc = (max_inc-min_inc))
income_gdp
income_gdp <-income_year %>%
group_by(country)
income_gdp <-income_year %>%
group_by(country)
filter(year == "1920" | year == "2020")%>%
summarise(min_inc = min(income, na.rm=T),
max_inc = max(income, na.rm=T),
change_inc = (max_inc-min_inc))
income_gdp <-income_year %>%
group_by(country)
income_gdp <-income_year %>%
group_by(country) %>%
filter(year == "1920" | year == "2020")%>%
summarise(min_inc = min(income, na.rm=T),
max_inc = max(income, na.rm=T),
change_inc = (max_inc-min_inc))
income_gdp
income_gdp <-income_year %>%
group_by(country) %>%
filter(year == "1920" | year == "2020")%>%
summarise(min_inc = min(income, na.rm=T),
max_inc = max(income, na.rm=T),
change_inc = (max_inc-min_inc)) %>%
top_n(5, change_inc)
income_gdp
income_gdp <-income_year %>%
group_by(country) %>%
filter(between(year, 1920,2020))%>%
summarise(min_inc = min(income, na.rm=T),
max_inc = max(income, na.rm=T),
change_inc = (max_inc-min_inc)) %>%
top_n(5, change_inc)
income_gdp
income_gdp <-income_year %>%
group_by(country) %>%
filter(year == 1920 | year ==2020)%>%
summarise(min_inc = min(income, na.rm=T),
max_inc = max(income, na.rm=T),
change_inc = (max_inc-min_inc)) %>%
top_n(5, change_inc)
income_gdp <-income_year %>%
group_by(country) %>%
filter(year == 1920 | year ==2020)%>%
summarise(min_inc = min(income, na.rm=T),
max_inc = max(income, na.rm=T),
change_inc = (max_inc-min_inc)) %>%
top_n(5, change_inc)
income_gdp
population_year %>%
filter(country == "China" |country == "India" | country == "Indonesia" | country == "Pakistan" | country == "United States", between(year, 1920, 2020)) %>%
ggplot(aes(x= year, y= population, color= country))+
geom_point(na.rm=T)+
labs(title = "Greatest Population Growth from 1920 to 2020",
x = "Year",
y = "Population")+
theme_linedraw()+
theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
axis.text.x = element_text(angle = 70, hjust = 1))+
scale_x_discrete(breaks=c("1920", "1925", "1930", "1935", "1940", "1945", "1950", "1955", "1960", "1965", "1970", "1975", "1980", "1985", "1990", "1995", "2000", "2005", "2010", "2015", "2020"))
income_year %>%
filter(country == "Qatar" | country == "Luxembourg" | country == "Singapore" | country == "Brunei" | country == "Ireland" , between(year, 1920, 2020)) %>%
ggplot(aes(x = year, y = income, group = country, color = country))+
geom_point(na.rm=T)+
labs(title = "Greatest Income Growth from 1920 to 2020",
x = "Year",
y = "Income")+
theme_linedraw()+
theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
axis.text.x = element_text(angle = 70, hjust = 1))+
scale_x_discrete(breaks=c("1920", "1925", "1930", "1935", "1940", "1945", "1950", "1955", "1960", "1965", "1970", "1975", "1980", "1985", "1990", "1995", "2000", "2005", "2010", "2015", "2020"))
life_expectancy_100 <- life_expectancy_100 %>%
filter(between(year, 1920, 2020))
life_expectancy_100 <- life_expectancy_year %>%
filter(between(year, 1920, 2020))
life_expectancy_100
population_100 <- population_year %>%
filter(between(year, 1920, 2020))
population_100
income_100 <- income_year %>%
filter(between(year, 1920, 2020))
income_100
```{r}
gapminder_join
gapminder_join <- inner_join(life_expectancy_100, population_100, by= c("country", "year"))
gapminder_join <- inner_join(gapminder_join, income_100, by= c("country", "year"))
gapminder_join
glimpse(gapminder_join)
glimpse(gapminder_join)
gapminder_join %>%
filter(year == 2020)
gapminder_join %>%
filter(year == 2020) %>%
group_by(country) %>%
summarise(max_inc = max(income, na.rm=T),
max_life_exp = max(life_expectancy, na.rm=T))
gapminder_join %>%
filter(year == 2020) %>%
group_by(country)
gapminder_join %>%
filter(year == 2020) %>%
group_by(country) %>%
ggplot(aes(x = income, y=life_expectancy))+
geom_point(na.rm=T)
gapminder_join %>%
filter(year == 2020) %>%
group_by(country) %>%
ggplot(aes(x = income, y=life_expectancy))+
geom_point(na.rm=T)+
labs(title = "Income v. Population in 2020",
x = "Income",
y = "Population")+
theme_linedraw()+
theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(here)
options(scipen=999) #disables scientific notation when printing
library(RColorBrewer)
library(paletteer)
population <- read_csv(here("midterm2", "data", "population_total.csv"))
population
income <- read_csv(here("midterm2", "data", "income_per_person_gdppercapita_ppp_inflation_adjusted.csv"))
income
life_expectancy <- read_csv(here("midterm2", "data", "life_expectancy_years.csv"))
life_expectancy
income_year<-income %>%
pivot_longer(-country,
names_to = "year",
values_to="income")
income_year
life_expectancy_year<-life_expectancy %>%
pivot_longer(-country,
names_to = "year",
values_to="life_expectancy")
life_expectancy_year
population_year <- population %>%
pivot_longer(-country,
names_to="year",
values_to="population")
population_year
income %>%
count() %>%
glimpse()
life_expectancy %>%
count()
population %>%
count()
life_expectancy_year %>%
filter(between(year, 1920,2020)) %>%
group_by(country) %>%
summarise(mean_life_exp = mean(life_expectancy)) %>%
top_n(n=-5)
life_expectancy_year %>%
filter(between(year, 1920,2020)) %>%
group_by(country) %>%
summarise(mean_life_exp = mean(life_expectancy)) %>%
top_n(n=5)
life_expectancy_year %>%
filter(year == 1920 |year == 2020) %>%
group_by(country) %>%
summarise(min_life_exp = min(life_expectancy, na.rm=T),
max_life_exp = max(life_expectancy, na.rm=T),
change_life_exp = (max_life_exp-min_life_exp)) %>%
top_n(5, change_life_exp)
life_expectancy_year %>%
filter(country == "Kuwait", between(year, 1920, 2020)) %>%
ggplot(aes(x= year, y= life_expectancy, color = country))+
geom_point(na.rm=T)+
labs(title = "Kuwait Life Expectancy from 1920 to 2020",
x = "Year",
y = "Life Expectancy")+
theme_linedraw()+
theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
axis.text.x = element_text(angle = 70, hjust = 1))+
scale_x_discrete(breaks=c("1920", "1925", "1930", "1935", "1940", "1945", "1950", "1955", "1960", "1965", "1970", "1975", "1980", "1985", "1990", "1995", "2000", "2005", "2010", "2015", "2020"))
population_year %>%
filter(year == 1920 |year == 2020) %>%
group_by(country) %>%
summarise(min_pop = min(population, na.rm=T),
max_pop = max(population, na.rm=T),
change_pop = (max_pop-min_pop)) %>%
top_n(5, change_pop)
population_year %>%
filter(country == "China" |country == "India" | country == "Indonesia" | country == "Pakistan" | country == "United States", between(year, 1920, 2020)) %>%
ggplot(aes(x= year, y= population, color= country))+
geom_point(na.rm=T)+
labs(title = "Greatest Population Growth from 1920 to 2020",
x = "Year",
y = "Population")+
theme_linedraw()+
theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
axis.text.x = element_text(angle = 70, hjust = 1))+
scale_x_discrete(breaks=c("1920", "1925", "1930", "1935", "1940", "1945", "1950", "1955", "1960", "1965", "1970", "1975", "1980", "1985", "1990", "1995", "2000", "2005", "2010", "2015", "2020"))
income_gdp <-income_year %>%
group_by(country) %>%
filter(year == 1920 | year ==2020)%>%
summarise(min_inc = min(income, na.rm=T),
max_inc = max(income, na.rm=T),
change_inc = (max_inc-min_inc)) %>%
top_n(5, change_inc)
income_gdp
income_year %>%
filter(country == "Qatar" | country == "Luxembourg" | country == "Singapore" | country == "Brunei" | country == "Ireland" , between(year, 1920, 2020)) %>%
ggplot(aes(x = year, y = income, group = country, color = country))+
geom_point(na.rm=T)+
labs(title = "Greatest Income Growth from 1920 to 2020",
x = "Year",
y = "Income")+
theme_linedraw()+
theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
axis.text.x = element_text(angle = 70, hjust = 1))+
scale_x_discrete(breaks=c("1920", "1925", "1930", "1935", "1940", "1945", "1950", "1955", "1960", "1965", "1970", "1975", "1980", "1985", "1990", "1995", "2000", "2005", "2010", "2015", "2020"))
life_expectancy_100 <- life_expectancy_year %>%
filter(between(year, 1920, 2020))
life_expectancy_100
population_100 <- population_year %>%
filter(between(year, 1920, 2020))
population_100
income_100 <- income_year %>%
filter(between(year, 1920, 2020))
income_100
gapminder_join <- inner_join(life_expectancy_100, population_100, by= c("country", "year"))
gapminder_join <- inner_join(gapminder_join, income_100, by= c("country", "year"))
gapminder_join
glimpse(gapminder_join)
gapminder_join %>%
filter(year == 2020) %>%
group_by(country) %>%
ggplot(aes(x = income, y=life_expectancy))+
geom_point(na.rm=T)+
labs(title = "Income v. Population in 2020",
x = "Income",
y = "Population")+
theme_linedraw()+
theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10))
